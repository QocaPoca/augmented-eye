<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AUGMENTED EYE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* ---------- GLOBAL HORROR THEME ---------- */
body {
    margin: 0;
    background: black;
    color: red;
    font-family: 'Courier New', monospace;
    overflow-x: hidden;
}

/* Background negative Japanese text */
body:before {
    content: "呪い 死 影 闇 憎い 怖い 血 人形 破滅 苦痛 怨霊 狂気";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    font-size: 100px;
    opacity: 0.03;
    writing-mode: vertical-rl;
    transform: rotate(10deg);
    pointer-events: none;
}

/* Navigation Bar */
nav {
    background: #111;
    padding: 15px;
    display: flex;
    gap: 20px;
    justify-content: center;
    border-bottom: 1px solid red;
}
nav a {
    color: red;
    text-decoration: none;
    font-size: 20px;
}
nav a:hover { text-shadow: 0 0 10px red; }

/* Title with blinking eye */
#title {
    text-align: center;
    font-size: 50px;
    margin-top: 20px;
    letter-spacing: 5px;
}
#eye {
    display: inline-block;
    width: 40px;
    height: 20px;
    border: 3px solid red;
    border-radius: 50%;
    position: relative;
    animation: blink 3s infinite;
}
#eye:after {
    content: "";
    position: absolute;
    top: 4px;
    left: 12px;
    width: 10px;
    height: 10px;
    background: red;
    border-radius: 50%;
}
@keyframes blink {
    0%, 90%, 100% { height: 20px; }
    95% { height: 2px; }
}

/* Containers */
.page { display: none; padding: 20px; }
.active { display: block; }

/* Particle canvas */
#particles {
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    pointer-events:none;
    z-index:-1;
}

/* Paper doll decorations */
.doll {
    position: fixed;
    top: 20px;
    width: 80px;
    opacity: 0.3;
}
#doll1 { left: 20px; }
#doll2 { right: 20px; transform: scaleX(-1); }

/* Simple buttons */
button {
    background: #200;
    color: red;
    border: 1px solid red;
    padding: 5px 15px;
    margin-top: 5px;
}
button:hover { background: #400; cursor:pointer; }

/* Image thumbnails */
img.post-img { width:150px; margin:10px; }

/* Leaderboards */
table { border-collapse: collapse; width: 70%; margin:20px auto; color:red; }
td, th { border:1px solid red; padding:5px; text-align:center; }

input, textarea {
    background:black;
    border:1px solid red;
    color:red;
    padding:5px;
}
</style>
</head>
<body>

<canvas id="particles"></canvas>

<img id="doll1" class="doll" src="https://i.imgur.com/2gU4FvX.png">
<img id="doll2" class="doll" src="https://i.imgur.com/2gU4FvX.png">

<div id="title">AUGMENTED <span id="eye"></span> EYE</div>

<nav>
    <a onclick="showPage('home')">Home</a>
    <a onclick="showPage('forum')">Forum</a>
    <a onclick="showPage('chat')">Chat</a>
    <a onclick="showPage('leaderboard')">Leaderboards</a>
    <a onclick="showPage('about')">About</a>
    <a onclick="showPage('account')">Account</a>
</nav>

<!-- ---------- PAGES ---------- -->

<!-- HOME / ANNOUNCEMENTS -->
<div id="home" class="page active">
    <h1>Announcements</h1>
    <div id="announceContainer"></div>
    <h3>Admin Post (Images Only)</h3>
    <div id="adminAnnounce"></div>
</div>

<!-- FORUM -->
<div id="forum" class="page">
    <h1>Forum — Image Posts Only</h1>
    <div id="forumPosts"></div>

    <h3>Post Image</h3>
    <input type="file" id="forumImg"><br>
    <button onclick="postForum()">Post</button>
</div>

<!-- CHAT -->
<div id="chat" class="page">
    <h1>Chatrooms</h1>

    <select id="chatroomSelect" onchange="loadChatroom()">
        <option>Channel 1</option>
        <option>Channel 2</option>
        <option>Channel 3</option>
        <option>Channel 4</option>
        <option>Channel 5</option>
    </select>

    <div id="chatWindow" style="border:1px solid red;height:300px;overflow:auto;padding:10px;margin-top:10px;"></div>

    <textarea id="chatMsg" placeholder="Message"></textarea><br>
    <input type="file" id="chatImg"><br>
    <button onclick="sendChat()">Send</button>
</div>

<!-- LEADERBOARD -->
<div id="leaderboard" class="page">
    <h1>Leaderboard</h1>
    <table id="lbTable"></table>

    <h3>Admin Input</h3>
    <div id="adminLeaderboard"></div>
</div>

<!-- ABOUT -->
<div id="about" class="page">
    <h1>About</h1>
    <p>
        Augmented∆Eye offers a battleground with fair rules and you can settle the match freely 
        as long as it is in agreement with both parties. Getting to the highest ranks gives you 
        special perks! And uncovering the mystery may lead you to the fabled Vault…
    </p>
</div>

<!-- ACCOUNT -->
<div id="account" class="page">
    <h1>Login / Register</h1>

    <div id="authForms">
        <input id="username" placeholder="Username"><br>
        <input id="password" type="password" placeholder="Password"><br>
        <button onclick="register()">Register</button>
        <button onclick="login()">Login</button>
    </div>

    <div id="profile" style="display:none;">
        <h2>Your Profile</h2>
        <img id="pfp" src="" style="width:100px;"><br>
        <input type="file" id="pfpInput"><br>
        <input id="displayName" placeholder="Display Name"><br>
        <button onclick="saveProfile()">Save</button>
        <button onclick="logout()">Logout</button>
    </div>

    <h3>Admin Mode</h3>
    <button onclick="toggleAdmin()">Toggle Admin</button>
    <p id="adminStatus"></p>
</div>

<script>
/* ============================================================
   PAGE SWITCHER
============================================================ */
function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

/* ============================================================
   ACCOUNT SYSTEM (localStorage)
============================================================ */
let currentUser = localStorage.getItem("currentUser") || null;
let admin = JSON.parse(localStorage.getItem("admin") || "false");

document.getElementById("adminStatus").innerText = admin ? "Admin = ON" : "Admin = OFF";

function register(){
    let u = username.value;
    let p = password.value;
    if(localStorage.getItem("user_"+u)) return alert("User exists");
    localStorage.setItem("user_"+u, JSON.stringify({password:p, pfp:"", name:u}));
    alert("Registered!");
}

function login(){
    let u = username.value;
    let p = password.value;
    let data = JSON.parse(localStorage.getItem("user_"+u) || "null");
    if(!data || data.password !== p) return alert("Invalid login");
    currentUser = u;
    localStorage.setItem("currentUser", u);
    loadProfile();
}

function logout(){
    currentUser = null;
    localStorage.removeItem("currentUser");
    document.getElementById("profile").style.display = "none";
    document.getElementById("authForms").style.display = "block";
}

function loadProfile(){
    if(!currentUser) return;
    let data = JSON.parse(localStorage.getItem("user_"+currentUser));
    pfp.src = data.pfp || "";
    displayName.value = data.name || currentUser;
    profile.style.display = "block";
    authForms.style.display = "none";
}

function saveProfile(){
    let data = JSON.parse(localStorage.getItem("user_"+currentUser));
    data.name = displayName.value;
    let file = pfpInput.files[0];
    if(file){
        let reader = new FileReader();
        reader.onload = () => {
            data.pfp = reader.result;
            localStorage.setItem("user_"+currentUser, JSON.stringify(data));
            pfp.src = data.pfp;
        };
        reader.readAsDataURL(file);
    } else {
        localStorage.setItem("user_"+currentUser, JSON.stringify(data));
    }
    alert("Saved!");
}

/* ============================================================
   ADMIN MODE
============================================================ */
function toggleAdmin(){
    admin = !admin;
    localStorage.setItem("admin", admin);
    adminStatus.innerText = admin ? "Admin = ON" : "Admin = OFF";
    loadAdminSections();
}

function loadAdminSections(){
    adminAnnounce.innerHTML = admin ? `
        <input type="file" id="announceImg"><br>
        <button onclick="postAnnounce()">Post Announcement</button>
    ` : "Admin only.";
    
    adminLeaderboard.innerHTML = admin ? `
        <input id="lbName" placeholder="Name">
        <input id="lbScore" placeholder="Score">
        <input id="lbRank" placeholder="# Rank (1-100)">
        <button onclick="addLeaderboard()">Add</button>
    ` : "Admin only.";
}

loadAdminSections();

/* ============================================================
   ANNOUNCEMENTS
============================================================ */
function postAnnounce(){
    let file = announceImg.files[0];
    let reader = new FileReader();
    reader.onload = ()=>{
        let arr = JSON.parse(localStorage.getItem("announcements") || "[]");
        arr.push(reader.result);
        localStorage.setItem("announcements", JSON.stringify(arr));
        loadAnnouncements();
    };
    reader.readAsDataURL(file);
}

function loadAnnouncements(){
    let arr = JSON.parse(localStorage.getItem("announcements") || "[]");
    announceContainer.innerHTML = "";
    arr.forEach(img=>{
        announceContainer.innerHTML += `<img class='post-img' src='${img}'>`;
    });
}
loadAnnouncements();

/* ============================================================
   FORUM
============================================================ */
function postForum(){
    if(!currentUser) return alert("Login first");
    let file = forumImg.files[0];
    let reader = new FileReader();
    reader.onload = ()=>{
        let arr = JSON.parse(localStorage.getItem("forum") || "[]");
        arr.push({img:reader.result, user:currentUser});
        localStorage.setItem("forum", JSON.stringify(arr));
        loadForum();
    };
    reader.readAsDataURL(file);
}

function loadForum(){
    let arr = JSON.parse(localStorage.getItem("forum") || "[]");
    forumPosts.innerHTML = "";
    arr.forEach(p=>{
        let u = JSON.parse(localStorage.getItem("user_"+p.user));
        forumPosts.innerHTML += `
            <div>
                <b>${u.name}</b><br>
                <img class='post-img' src='${p.img}'>
            </div>`;
    });
}
loadForum();

/* ============================================================
   CHATROOMS
============================================================ */
function loadChatroom(){
    let room = chatroomSelect.value;
    let msgs = JSON.parse(localStorage.getItem("chat_"+room) || "[]");
    chatWindow.innerHTML = "";
    msgs.forEach(m=>{
        chatWindow.innerHTML += `<div><b>${m.user}</b>: ${m.text} ${m.img?("<br><img class='post-img' src='"+m.img+"'>"):""}</div><hr>`;
    });
}

function sendChat(){
    if(!currentUser) return alert("Login first");
    let room = chatroomSelect.value;
    let text = chatMsg.value;
    let file = chatImg.files[0];
    let reader = new FileReader();

    reader.onload = ()=>{
        let arr = JSON.parse(localStorage.getItem("chat_"+room) || "[]");
        arr.push({user:currentUser, text:text, img: reader.result});
        localStorage.setItem("chat_"+room, JSON.stringify(arr));
        chatMsg.value="";
        chatImg.value="";
        loadChatroom();
    };
    if(file) reader.readAsDataURL(file);
    else {
        let arr = JSON.parse(localStorage.getItem("chat_"+room) || "[]");
        arr.push({user:currentUser, text:text, img:null});
        localStorage.setItem("chat_"+room, JSON.stringify(arr));
        chatMsg.value="";
        loadChatroom();
    }
}

/* ============================================================
   LEADERBOARD
============================================================ */
function addLeaderboard(){
    let name = lbName.value;
    let score = lbScore.value;
    let rank = lbRank.value;
    let arr = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    arr.push({name, score, rank});
    localStorage.setItem("leaderboard", JSON.stringify(arr));
    loadLeaderboard();
}

function loadLeaderboard(){
    let arr = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    lbTable.innerHTML = "<tr><th>Rank</th><th>Name</th><th>Score</th></tr>";
    arr.sort((a,b)=>a.rank - b.rank);
    arr.forEach(e=>{
        lbTable.innerHTML += `<tr><td>${e.rank}</td><td>${e.name}</td><td>${e.score}</td></tr>`;
    });
}
loadLeaderboard();

/* ============================================================
   PARTICLE ANIMATION
============================================================ */
let c = document.getElementById("particles");
let ctx = c.getContext("2d");
c.width = innerWidth;
c.height = innerHeight;
let particles = [];

for(let i=0;i<150;i++){
    particles.push({
        x: Math.random()*c.width,
        y: Math.random()*c.height,
        s: Math.random()*2+1,
        v: Math.random()*0.5+0.2
    });
}

function animate(){
    ctx.clearRect(0,0,c.width,c.height);
    ctx.fillStyle="red";

    particles.forEach(p=>{
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.s,0,Math.PI*2);
        ctx.fill();
        p.y += p.v;
        if(p.y>c.height) p.y=0;
    });

    requestAnimationFrame(animate);
}
animate();

</script>
</body>
</html>
